<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>

    <div *ngIf="!isSearchbarVisible" class="barKronos">
        <ion-title class="title">
          <span>Home</span>
          <span style="float: right">{{kronos}}</span>
        </ion-title>
    </div>

    <ion-buttons slot="end">
      <ion-button (click)="toggleSearchbar()">
        <ion-icon name="search-outline"></ion-icon>
      </ion-button>
      <ion-button>
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
    </ion-buttons>

  <ion-searchbar (ionChange)="search($event)" showCancelButton search-icon="search" placeholder="Search" *ngIf="isSearchbarVisible"></ion-searchbar>

  </ion-toolbar>
</ion-header>


<ion-content [fullscreen]="true" [scrollEvents]="true" (ionScroll)="onContentScroll($event)">
<div *ngIf="!isSearchbarVisible" class="homePage">
<!-- Background image overlay -->
<div class="glassyBackground">
  <img src="assets/images/glassy_lights.jpg" />
  <div class="glassyBackgroundFade"></div>
</div>

  <br /><br />
  <!-- HOME BANNER -->
<div>
  <!-- App logo -->
  <ion-img class="logo" src="assets/logos/logo.svg"></ion-img>

  <ion-card-subtitle class="kronos">
    {{kronos}}
  </ion-card-subtitle>

  <ng-container *ngIf="(profile$ | async) as profile;">
    <ion-avatar class="avatar">
      <img alt="Avatar" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
    </ion-avatar>
  </ng-container>

</div>


  <br /><br />
  <!-- RECOMMENDED -->
  <h3 class="sectionTitle">RECOMMENDED FOR YOU</h3>
  <div>
    <!-- <ion-slides [options]="{ slidesPerView: 'auto', zoom: true, grabCursor: true }"> -->
    <ion-slides [options]="{ slidesPerView: 1.5, freeMode: true }">

      <ion-slide *ngFor="let item of recommended">
        <ion-col>
          <ion-img [src]="item.img"></ion-img>
          <div class="overlay">
            <ion-label>{{item.title}}</ion-label>
            <div class="reactions">
              likes | comments
            </div>
          </div>
        </ion-col>
      </ion-slide>

    </ion-slides>
  </div>

  <br /><br />

  <!-- GRAVEYARD -->
  <h3 id="graveyardTitle" class="sectionTitle">TODAY'S GRAVEYARD</h3>
  <div class="graveyard">

    <div class="gravestones">
      <ion-avatar class="gravestone" *ngFor="let gs of [1, 2, 3, 4, 5, 6, 7, 8]">
        <img alt="Avatar" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
      </ion-avatar>
    </div>

    <div class="feelingBad">
      <ion-grid>
        <ion-row>
          <ion-col size="8">
            <ion-card-title>
              Feeling bad?
            </ion-card-title>
            <ion-card-subtitle>
              Look at all these plebs.<br />Someone ought to give them a second chance.
            </ion-card-subtitle>
          </ion-col>

          <ion-col size="4">
            <ion-button class="glassyButton">
              RESURRECT
            </ion-button>
          </ion-col>
      </ion-row>
      </ion-grid>
    </div>
  </div>

  <br /><br />

  <!-- TRENDING list -->
  <h3 class="sectionTitle">TRENDING</h3>
  <ion-list>

  <!-- <ion-infinite-scroll (ionInfinite)="loadData($event)">
    <ion-infinite-scroll-content loadingSpinner="circular" loadingText="Foraging...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll> -->

  <div class="trendingPost" *ngFor="let item of trending">
    <ion-card class="trendingItem" (click)="openBlip(item)">

      <div class="image">
        <ion-img [src]="item.img"></ion-img>
      </div>

      <ion-label stacked>
        <ion-grid>
          <ion-row>

            <!-- Title + Description -->
            <ion-col class="subtext" size="9">
              <h2>{{item.title}}</h2>
              <br/>
              <h4>{{item.desc}}</h4>
            </ion-col>

            <!-- Profile, Time posted, Reactions -->
            <!-- TODO: Clean this up -->
            <ion-col class="actions">
              <ion-grid>
                <ion-row class="profile">
                    <span style="padding-right: 0.1em;">Hello world</span> 
                    <ion-avatar style="display: inline; width: 5vw; height: 5vw">
                      <img alt="Avatar" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
                    </ion-avatar>
                </ion-row>
              </ion-grid>
                <!-- <ion-label>Item Avatar</ion-label> -->
            </ion-col>

          </ion-row>
        </ion-grid>
      </ion-label>
    </ion-card>
    <hr />
  </div>

  </ion-list>
</div>

<div *ngIf="isSearchbarVisible" class="searchResults">
  <ion-row class="searchType">
    <ion-col>
      <ion-button expand="block" color="grey" class="SearchTypeButton" id="SearchUserButton" (click) = "toggleToUsers()">
        Users
      </ion-button>
    </ion-col>
    <ion-col>
      <ion-button expand="block" class="SearchTypeButton" id="SearchPostButton" (click) = "toggleToPosts()">
        Posts
      </ion-button>
    </ion-col>
  </ion-row>
  
  <ng-template [ngIf]="userToggle" [ngIfElse]="posts">
    <ion-list class="searchResultsType">
      <ion-item (click)="toUser(user.name, user.profileId, user.photoURL)" *ngFor="let user of searchResultsUsers">
        <ion-avatar class="Profile-Pic">
          <img src="" alt="">
        </ion-avatar>
        &nbsp;
        &nbsp;
        <ion-label>
          <h2>{{ user.name }}</h2>
          <p>{{ user.email }}</p>
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-template>
  
  <ng-template #posts>
    <ion-list class="searchResultsType">
      <ion-item (click)="toPost(post.user_id, post.postId)" *ngFor="let post of searchResultsPosts">
        <ion-label>
          <ion-thumbnail style="float: right" slot="start">
            <img src="{{ post.content }}" alt="Img">
          </ion-thumbnail>
          <ion-label>
            <h2>{{ post.caption }}</h2>
            <p>Posted by: {{ post.username }}</p>
          </ion-label>
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-template>
  
</div>
</ion-content>